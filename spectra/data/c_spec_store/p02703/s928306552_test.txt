Input:
5 7 10
1 2 3 4
2 3 2 5
3 4 1 6
4 5 4 7
1 3 5 8
2 4 3 9
1 5 2 10
3 4
2 5
1 6
4 3
5 2

Output:
4
8
13
10