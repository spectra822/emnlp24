


<h1><font color="#000000">Problem C:</font> Differential Pulse Code Modulation</h1>
<!--
<h3><U>差分パルス符号変調</U></h3>
-->


<p>差分パルス符号変調は主に音声信号を圧縮する際に用いられる圧縮手法の一つである．</p>

<p>音声信号は計算機上では整数列(インパルス列)として扱われる．整数列は入力信号を一定時間間隔で標本化(サンプリング)し，振幅を記録したものである．一般にこの整数列は前後の値が近いという傾向がある．これを利用し，前後の値の差分を符号化し，圧縮率を向上させるのが差分パルス符号変調である．</p>

<p>本問題では差分の値をあらかじめ定められた値の集合から選ぶことを考える．この値の集合をコードブックと呼ぶことにする．復号化後の音声信号
<i>y<sub>n</sub></i> は以下の式で定められる．</p>
<blockquote><i>y</i><sub><i>n</i></sub> = <i>y</i><sub><i>n</i>
- 1</sub> + <i>C</i>[<i>k</i><sub><i>n</i></sub>]</blockquote>

<p>ここで <i>k</i><sub><i>n</i></sub> はプログラムによって出力される出力系列， <i>C</i>[<i>j</i>]
はコードブックの <i>j</i> 番目の値である．ただし <i>y</i><sub><i>n</i></sub>
は加算によって0未満の値となった場合は0に，255より大きい値となった場合は255にそれぞれ丸められる．また， <i>y</i><sub>0</sub>
の値は128とする．</p>
<p>あなたの仕事は，入力信号とコードブックが与えられたときに，元の入力信号と復号化後の出力信号との差の二乗和が最小となるように出力系列を選んで，そのときの差の二乗和を出力するプログラムを書くことである．</p>
<p>例えば，コードブックとして <i>{4, 2, 1, 0, -1, -2, -4}</i> という値のセットを使って
<i>131, 137</i> という列を圧縮する場合，
<i>y</i><sub><i>0</i></sub><i> = 128</i>, 
<i>y</i><sub><i>1</i></sub><i> = 128 + 4 = 132</i>, 
<i>y</i><sub><i>2</i></sub><i> = 132 + 4 = 136</i> という列に圧縮すると
二乗和が <i>(131 - 132)^2 + (137 - 136)^2 = 2</i> と最小になる．</p>
<p>また，同じくコードブックとして <i>{4, 2, 1, 0, -1, -2, -4}</i> という値のセットを使って
<i>131, 123</i> という列を圧縮する場合，
<i>y</i><sub><i>0</i></sub><i> = 128</i>, 
<i>y</i><sub><i>1</i></sub><i> = 128 + 1 = 129</i>, 
<i>y</i><sub><i>2</i></sub><i> = 129 - 4 = 125</i> と，先程の例とは違って
<i>131</i> により近づく <i>+2</i> を採用しない方が
<i>(131 - 129) ^ 2 + (123 - 125) ^ 2 = 8</i>
というより小さな二乗和が得られる．</p>
<p>上記 2つの例は sample input の最初の 2例である．</p>


<h2>Input</h2>


<p>入力は複数のデータセットから構成される．各データセットの形式は次に示すとおりである．</p>

<blockquote><i>N</i> <i>M</i><br />
<i>C<sub></sub>1</i><br />
<i>C<sub>2</sub></i><br />
...<br />
<i>C<sub>M</sub></i><br />
<i>x<sub>1</sub></i><br />
<i>x<sub>2</sub></i><br />
...<br />
<i>x<sub>N</sub></i><br />
</blockquote>

<p>最初の行は，入力データセットの大きさを規定する． <i>N</i> は圧縮する入力信号の長さ(サンプル数)である． <i>M</i>
はコードブックに含まれる値の個数である． <i>N</i> 及び <i>M</i> は1 &le; <i>N</i> &le; 20000，1
&le; <i>M</i> &le; 16を満たす．</p>

<p>これに続く <i>M</i> 行は，コードブックの記述である． <i>C<sub>i</sub></i> はコードブックに含まれる
<i>i</i> 番目の値を表す． <i>C<sub>i</sub></i> は-255 &le; <i>C<sub>i</sub></i>
&le; 255を満たす．</p>

<p>これに続く <i>N</i> 行は，入力信号の記述である． <i>x<sub>i</sub></i> は入力信号を表す整数列の <i>i</i>
番目の値である． <i>x<sub>i</sub></i> は0 &le; <i>x<sub>i</sub></i> &le; 255を満たす．</p>

<p>データセットの中の入力項目は，すべて整数である．入力の終りは，空白文字1個で区切られた2個のゼロのみからなる行で表される．</p>

<h2>Output</h2>


<p>入力の各データセットに対して， 元の入力信号と復号化後の出力信号との差の二乗和の最小値を一行で出力せよ．</p>


<h2>Sample Input</h2>
<pre>
2 7
4
2
1
0
-1
-2
-4
131
137
2 7
4
2
1
0
-1
-2
-4
131
123
10 7
-4
-2
-1
0
1
2
4
132
134
135
134
132
128
124
122
121
122
5 1
255
0
0
0
0
0
4 1
0
255
0
255
0
0 0
</pre>

<h2>Output for the Sample Input</h2>
<pre>
2
8
0
325125
65026
</pre>
