



<h1>KND Factory</h1>
<h2>Problem</h2>

<p>
KND君は会津大学に在籍する学生プログラマである。彼の住む町の周辺には<var> N </var>個の町がある。彼は生クリームが大好きなので毎日生クリームを食べるためにある町に工場を建設した。その工場では毎日<var> F </var>リットルの生クリームが製造される。生クリームは運ぶたびに、移動元の町の気温と移動先の町の気温の絶対差だけ傷んでしまう。困ったことにこの近辺の町の気温は寒暖計によって計測できない。しかしながら調査によって、それぞれの町の気温を変数とした<var> N </var>個の一次方程式からなる<var> N </var>元一次連立方程式を導くことができた。あなたはこれを解くことによって各町の気温を知ることができる。また、ある町から他の町へ生クリームを運搬するにはパイプラインを用いる。パイプラインは一日に送ることのできる生クリームの量が限られている。一日に<var> F </var>リットルの生クリームを工場がある町<var> s </var>からKND君が住む町<var> t </var>へ生クリームをなるべく良い状態で送りたい。町には0から始まる番号がつけられているものとする。方程式の各項は高々ひとつの変数からなり定数項がひとつある。<var> F </var>リットルの生クリームはどのような運び方をしても一日以内で任意の町へ送られる。<br>
</p>

<h2>Input</h2>
<p>入力は複数のテストケースからなる。ひとつのテストケースは以下の形式で与えられる。テストケースの数は入力として与えられる。</p>
<pre>
<var>T</var>
<var>N</var> <var>s</var> <var>t</var> <var>F</var>
<var>a<sub>1,1</sub></var> <var>a<sub>1,2</sub></var> ... <var>a<sub>1,N</sub></var> <var>c<sub>1</sub></var>
<var>a<sub>2,1</sub></var> <var>a<sub>2,2</sub></var> ... <var>a<sub>2,N</sub></var> <var>c<sub>2</sub></var>
...
<var>a<sub>N,1</sub></var> <var>a<sub>N,2</sub></var> ... <var>a<sub>N,N</sub></var> <var>c<sub>N</sub></var>
<var>M<sub>1</sub></var>
<var>d<sub>1,1</sub></var> <var>d<sub>1,2</sub></var> ... <var>d<sub>1,M<sub>1</sub></sub></var>
<var>f<sub>1,1</sub></var> <var>f<sub>1,2</sub></var> ... <var>f<sub>1,M<sub>1</sub></sub></var>
<var>M<sub>2</sub></var>
<var>d<sub>2,1</sub></var> <var>d<sub>2,2</sub></var> ... <var>d<sub>2,M<sub>2</sub></sub></var>
<var>f<sub>2,1</sub></var> <var>f<sub>2,2</sub></var> ... <var>f<sub>2,M<sub>2</sub></sub></var>
...
<var>M<sub>N</sub></var>
<var>d<sub>N,1</sub></var> <var>d<sub>N,2</sub></var> ... <var>d<sub>N,M<sub>2</sub></sub></var>
<var>f<sub>N,1</sub></var> <var>f<sub>N,2</sub></var> ... <var>f<sub>N,M<sub>2</sub></sub></var>
</pre>
<p>ここで、
</p>
<ul>
<li><var>T</var>:テストケースの数</li>
<li><var>N</var>:町の数</li>
<li><var>s</var>:工場のある町</li>
<li><var>t</var>:KND君の住む町</li>
<li><var>F</var>:一日に作られる生クリームの量</li>
<li><var>a<sub>i,j</sub></var>:連立方程式の未知数としてのi番目の方程式中でj番目の町の気温にかかる係数。もし<var>a<sub>i,j</sub></var>=0ならj番目の町の気温はこの方程式に現れないことになる。以下の例も参照してほしい。</li>
<li><var>c<sub>i</sub></var>:i番目の方程式の定数項</li>
<li><var>M<sub>i</sub></var>:i番目の町が持っている生クリームを移動させる機械の数</li>
<li><var>d<sub>i,j</sub></var>:i番目の町が持っているj番目の機械が生クリームを移動させる先の町</li>
<li><var>f<sub>i,j</sub></var>:i番目の町が持っているj番目の機械が生クリームを1日に移動させられるリットル量</li>
</ul>
<p>
である。
</p>
<p>
<var>N</var>元一次連立方程式を表す行列の入力例:<br>
</p>
<pre>
 a +  b      = 6       1  1 0  6
3a + 2b + c  = 10  =>  3  2 1 10
 a - 2b + 3c = 6       1 -2 3  6
</pre>
<p>
a,b,cが町0,1,2の気温を表す。
</p>

<h2>Constraints</h2>
<p>入力は以下の条件を満たす。</p>
<ul>
<li>入力はすべて整数。</li>
<li>0 &lt;<var> T </var>&le; 40</li>
<li>2 &lt;<var> N </var>&le; 100</li>
<li>0 &le;<var> s </var>&lt;<var> N </var></li>
<li>0 &le;<var> t </var>&lt;<var> N </var></li>
<li><var>s</var> &ne; <var>t</var></li>
<li>0 &lt;<var> F </var>&le; 1000</li>
<li>0 &le;<var> M<sub>i</sub> </var>&le;<var> N </var></li>
<li>-1000 &le; <var>a<sub>i,j</sub></var> &le; 1000</li>
<li>0 &le;<var>f<sub>i,j</sub></var>&lt; 1000</li>
<li>それぞれの町の気温は一意に定まる。</li>
</ul>

<h2>Output</h2>
<p>
各テストケースにつき、一日に<var> F </var>リットルの生クリームを工場がある町<var> s </var>からKND君が住む町<var> t </var>に運んだとき、生クリームの傷みの和を最小化した値を一行で出力せよ。この値はジャッジ出力の値と10<sup>-5</sup>より大きい差を持ってはならない。また、町<var> s </var>から町<var> t </var>へ<var> F </var>リットルの生クリームを一日に運べない場合はimpossibleを一行で出力せよ。
</p>

<h2>Sample Input</h2>
<pre>
3
3 0 2 5
1 1 1 6
3 2 1 10
1 -2 3 6
2
1 2
3 3
1
2
3
0
3 0 2 5
1 1 1 6
3 2 1 10
1 -2 3 6
2
1 2
2 2
1
2
2
0
10 2 7 20
8 9 -5 6 -9 5 1 0 4 9 4
3 -1 -8 0 -5 4 3 0 -3 2 4
-4 5 8 -4 1 -8 -6 3 3 5 -7
-7 0 2 5 8 -5 -9 -8 1 -2 -1
3 8 1 -3 8 2 -5 8 -3 4 -4
-2 5 0 -2 -4 4 -3 9 6 -1 -2
4 1 2 -9 3 5 6 -4 4 -1 -4
-4 6 6 9 -2 1 -9 -3 -7 3 -4
1 -1 6 3 1 -5 9 5 -5 -9 -5
-7 4 6 8 8 4 -4 4 -7 -8 -5
5
1 5 0 6 3
15 17 14 7 15
3
1 5 7
6 8 14
10
3 5 3 5 9 5 9 5 1 4
12 6 16 11 16 7 9 3 13 13
10
9 1 5 6 2 5 8 5 9 4
15 8 8 14 13 13 18 1 12 11
5
3 5 0 4 6
14 15 4 14 11
9
5 0 6 2 7 8 8 6 6
6 5 7 17 17 17 17 19 3
9
7 7 2 7 8 4 7 7 0
4 13 16 10 19 17 19 12 19
3
1 5 1
3 7 16
8
5 7 4 9 1 4 6 8
4 3 6 12 6 19 10 1
4
1 3 6 3
5 15 18 14
</pre>

<h2>Sample Output</h2>
<pre>
10.0000000000
impossible
11.9354380207
</pre>