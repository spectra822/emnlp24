


<H1>問題 4:　部活のスケジュール表 (Schedule)
</H1>
<br/>

<h2>問題</h2>
<p>
IOI 高校のプログラミング部には，J 君と O 君と I 君の 3 人の部員がいる．
プログラミング部では，部活のスケジュールを組もうとしている．
</p>

<p>
今，N 日間の活動のスケジュールを決めようとしている．
各活動日のスケジュールとして考えられるものは，各部員については活動に参加するかどうかの 2 通りがあり，部としては全部で 8 通りある．
部室の鍵はただ 1 つだけであり，最初は J 君が持っている．
各活動日には，その日の活動に参加する部員のうちのいずれか 1 人が鍵を持っている必要があり，活動後に参加した部員のいずれかが鍵を持って帰る．
</p>

<p>
プログラミング部では，活動日には毎回必ず活動が行われるように，あらかじめ各活動日の責任者を定めた．
責任者は，必ずその日の活動に出席しなければならない．
</p>

<p>
スケジュールを決めようとしている日数と，各活動日の責任者が誰であるかの情報が与えられた時，すべての活動日に部活動を行うことができるようなスケジュール表として考えられるものの数を 10007 で割った余りを求めるプログラムを作成せよ．
ただし，部活の終了時に鍵を持って帰る部員は，その日の活動に参加している部員の誰でもよく，最終日は誰が鍵を持って帰ってもよいものとする．
</p>

<h2>入力</h2>

<p>
入力は，2 行からなる．
</p>

<p>
1 行目には，スケジュールを決めようとしている日数を表す 1 つの整数 N (2 &le; N &le; 1000) が書かれている．
</p>

<p>
2 行目には，各活動日の責任者を表す N 文字からなる文字列が書かれている．
この文字列の i 文字目 (1 &le; i &le; N) は，i 日目の活動日の責任者を表す．
すなわち，i 文字目が J, O, I であることはそれぞれ i 日目の活動日の責任者が J 君，O 君，I 君であることを意味する．
</p>

<h2>出力</h2>
<p>
スケジュール表として考えられるものの数を 10007 で割った余りを 1 行で出力せよ．
</p>

<h2>入出力例</h2>

<h3>入力例 1</h3>

  <pre>
2
OI
</pre>

<h3>出力例 1</h3>
   <pre>
7
</pre>

<p>
入出力例 1 において，2 日間の活動日のスケジュールを考える．1 日目の責任者は O 君，2 日目の責任者は I 君である．
問題文の条件をみたすスケジュール表は 7 通り考えられる．
</p>

<table style="margin-left: 50px; margin-right: 50px;">
 <tr>
  <th></th>
  <th>&nbsp;1 日目&nbsp;</th>
  <th>&nbsp;2 日目&nbsp;</th>
 </tr>
 <tr>
  <th>スケジュール 1&nbsp;&nbsp;&nbsp;</th>
  <td align="center">J, O</td>
  <td align="center">O, I</td>
 </tr>
 <tr>
  <th>スケジュール 2&nbsp;&nbsp;&nbsp;</th>
  <td align="center">J, O</td>
  <td align="center">J, I</td>
 </tr>
 <tr>
  <th>スケジュール 3&nbsp;&nbsp;&nbsp;</th>
  <td align="center">J, O</td>
  <td align="center">J, O, I</td>
 </tr>
 <tr>
  <th>スケジュール 4&nbsp;&nbsp;&nbsp;</th>
  <td align="center">J, O, I</td>
  <td align="center">I</td>
 </tr>
 <tr>
  <th>スケジュール 5&nbsp;&nbsp;&nbsp;</th>
  <td align="center">J, O, I</td>
  <td align="center">J, I</td>
 </tr>
 <tr>
  <th>スケジュール 6&nbsp;&nbsp;&nbsp;</th>
  <td align="center">J, O, I</td>
  <td align="center">O, I</td>
 </tr>
 <tr>
  <th>スケジュール 7&nbsp;&nbsp;&nbsp;</th>
  <td align="center">J, O, I</td>
  <td align="center">J, O, I</td>
 </tr>
</table>
<br>


<p> 
この表では，J, O, I はそれぞれその日に J 君, O 君, I 君が参加することを表す．
1 日目の責任者は O 君であるが，最初鍵を持っているのは J 君であるため，1 日目の活動には J 君, O 君の両方が参加する必要があることに注意せよ．
また，1 日目に鍵を持って帰った人は 2 日目にも参加しないといけないので，1 日目と 2 日目の両方に参加する人が少なくとも 1 人存在しなければならないことに注意せよ．
</p>

<br>
   
<h3>入力例 2</h3>  

  <pre>
20
JIOIJOIJOJOIIIOJIOII
</pre>

<h3>出力例 2</h3>

   <pre>
4976
</pre>

<p>
入出力例 2 において，条件をみたすスケジュール表は全部で 72493594992 通り考えられる．それを 10007 で割った余りである 4976 を出力する．
</p>


<div class="source">
<p class="source">
問題文と自動審判に使われるデータは、<a href="http://www.ioi-jp.org">情報オリンピック日本委員会</a>が作成し公開している問題文と採点用テストデータです。
</p>
</div>
