
<h1>Usoperanto</h1>

<p>Usoperanto is an artificial spoken language designed and regulated by Usoperanto Academy.
The academy is now in study to establish Strict Usoperanto, a variation of the language intended for formal documents.
</p>
<p>In Usoperanto, each word can modify at most one other word, and modifiers are always put before modifiees.
For example, with a noun <i>uso</i> (&quot;truth&quot;) modified by an adjective <i>makka</i> (&quot;total&quot;), people say <i>makka uso</i>, not <i>uso makka</i>.
On the other hand, there have been no rules about the order among multiple words modifying the same word,
so in case <i>uso</i> is modified by one more adjective <i>beta</i> (&quot;obvious&quot;),
people could say both <i>makka beta uso</i> and <i>beta makka uso</i>.
</p>
<p>In Strict Usoperanto, the word order will be restricted according to <i>modification costs</i>.
Words in a phrase must be arranged so that the total modification cost is minimized.
Each pair of a modifier and a modifiee is assigned a cost equal to the number of letters between the two words;
the total modification cost is the sum of the costs over all modifier-modifiee pairs in the phrase.
For example, the pair of <i>makka</i> and <i>uso</i> in a phrase <i>makka beta uso</i> has the cost of 4 for <i>beta</i> (four letters).
As the pair of <i>beta</i> and <i>uso</i> has no words in between and thus the cost of zero, <i>makka beta uso</i> has the total modification cost of 4.
Similarly <i>beta makka uso</i> has the total modification cost of 5.
Applying the &quot;minimum total modification cost&quot; rule, <i>makka beta uso</i> is preferred to <i>beta makka uso</i> in Strict Usoperanto.
</p>
<p>Your mission in this problem is to write a program that, given a set of words in a phrase, finds the correct word order in Strict Usoperanto and reports the total modification cost.
</p>

<h2>Input</h2>

<p>The format of the input is as follows.
</p>
<blockquote>
<var>N</var><br><var>M<sub>0</sub></var> <var>L<sub>0</sub></var><br><var>...</var><br><var>M<sub>N-1</sub></var> <var>L<sub>N-1</sub></var><br></blockquote>

<p>The first line contains an integer
<!--<var>N</var> (<var>1 &le; N &le; 160,000</var>).-->
<var>N</var> (<var>1 &le; N &le; 10<sup>6</sup></var>).
<var>N</var> is the number of words in a phrase.
</p>
<p>Each of the following <var>N</var> lines contains two integers
<var>M<sub>i</sub></var> (<var>1 &le; M<sub>i</sub> &le; 10</var>) and
<var>L<sub>i</sub></var> (<var>-1 &le; L<sub>i</sub> &le; N - 1</var>, <var>L<sub>i</sub> &ne; i</var>)
describing the <var>i</var>-th word (<var>0 &le; i &le; N-1</var>).
<var>M<sub>i</sub></var> is the number of the letters in the word.
<var>L<sub>i</sub></var> specifies the modification:
<var>L<sub>i</sub> = -1</var> indicates it does not modify any word;
otherwise it modifies the <var>L<sub>i</sub></var>-th word.
</p>
<p>Note the first sample input below can be interpreted as the <i>uso</i>-<i>beta</i>-<i>makka</i> case.
</p>

<h2>Output</h2>

<p>Print the total modification cost.
</p>

<h2>Sample Input 1</h2>

<pre>3
3 -1
4 0
5 0
</pre>

<h2>Output for the Sample Input 1</h2>

<pre>4
</pre>

<h2>Sample Input 2</h2>

<pre>3
10 -1
10 0
10 1
</pre>

<h2>Output for the Sample Input 2</h2>

<pre>0
</pre>

<h2>Sample Input 3</h2>

<pre>4
1 -1
1 0
1 1
1 0
</pre>


<h2>Output for the Sample Input 3</h2>

<pre>1
</pre>
