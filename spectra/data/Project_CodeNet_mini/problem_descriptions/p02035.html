
<h2>F: 赤黒そーるじぇむ / Red-Black Soul Gem</h2>

<h3>問題</h3>

<p>
ほむちゃんは、そーるじぇむを赤色や黒色に変化させたり、 異なる <var>2</var> つのそーるじぇむ間を魔法の糸で接続したりする不思議な力を持っています。
この力を使うことで、ほむちゃんは、そーるじぇむによる魔方陣を作ることができます。
</p>

<p>ほむちゃんは、 <var>1</var> から <var>N</var> で番号付けられた <var>N</var> 個のそーるじぇむがあるとき、以下の条件が成り立つ異なる魔方陣がいくつあるのか気になりました。</p>

<ul>
<li> どの <var>2</var> つのそーるじぇむ間も、高々 <var>1</var> 回しか接続されない。</li>
<li> すべてのそーるじぇむの色が、赤色か黒色のいずれかになっている。</li>
<li> 任意のそーるじぇむに対して、自身の色と異なる色のそーるじぇむのうち、少なくとも <var>1</var> つと接続されている。</li>
</ul>

<p>
このとき、魔方陣はそーるじぇむを頂点とし、魔法の糸を辺とするグラフとみなすことができます。
ここで、そのグラフは <b>連結でなくてもよい</b> ことに注意してください。
</p>

<p>
ほむちゃんは計算が苦手なので、代わりにあなたが高速なプログラムを作って異なる魔方陣の数を計算してあげましょう。
しかし、その数は非常に多いことが予想されるので、ある素数 <var>M</var> で割った余りを求めることにします。
</p>

<p>なお、ある魔方陣 <var>G</var> と <var>H</var> が異なるとは、あるそーるじぇむ <var>v</var> について <var>G</var> と <var>H</var> でその色が異なる、もしくはあるそーるじぇむの組 <var>u</var>, <var>v</var> が <var>G</var> と <var>H</var> の一方でのみ接続されていることを指します。</p>

<h3>入力形式</h3>

<pre><var>N</var> <var>M</var></pre>

<h3>制約</h3>

<ul>
<li> <var>2 \leq N \leq 2,000</var></li>
<li> <var>10^8 \leq M \leq 10^9 + 7</var></li>
<li> <var>M</var> は素数であることが保証される</li>
</ul>

<h3>出力形式</h3>

<p>条件を満たすグラフの個数を <var>M</var> で割った余りを整数で <var>1</var> 行に出力してください。</p>

<h3>入力例1</h3>
<pre>3 310779401</pre>

<h3>出力例1</h3>
<pre>12</pre>

<p>例えば、以下のような魔方陣は条件を満たします。</p>

<object data="https://judgeapi.u-aizu.ac.jp/resources/images/hupc2019_rupc2019-f-001.jpg" type="image/jpeg" width="300"></object>

<h3>入力例2</h3>
<pre>7 566666561</pre>

<h3>出力例2</h3>
<pre>98638848</pre>

<p>例えば、以下のような魔方陣は条件を満たします。</p>

<object data="https://judgeapi.u-aizu.ac.jp/resources/images/hupc2019_rupc2019-f-002.jpg" type="image/jpeg" width="400"></object>

<h3>入力例3</h3>
<pre>1010 1000000007</pre>

<h3>出力例3</h3>
<pre>862232855</pre>

<p><var>M</var> で割った余りを出力することに注意してください。</p>
