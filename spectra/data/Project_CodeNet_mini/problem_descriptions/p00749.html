
<h1><font color="#000000">Problem D:</font> Off Balance</h1>
<!-- end en only -->



<!-- begin en only -->
<p>
You are working for an administration office of the International
Center for Picassonian Cubism (ICPC), which plans to build a new art
gallery for young artists.  The center is organizing an architectural
design competition to find the best design for the new building.
</p>

<p>Submitted designs will look like a screenshot of a well known
game as shown below.</p>
<!-- end en only -->

<p style="text-align: center">
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_D2010_D-1">
</p>

<!-- begin en only -->
<p>This is because the center specifies that 
the building should be constructed by stacking regular units
called <i>pieces</i>, each of which consists of four cubic blocks.
In addition, the center requires the competitors to submit designs
that satisfy the following restrictions.
</p>
<ul>
<li>All the pieces are aligned.  When two pieces touch each other, the faces of
the touching blocks must be placed exactly at the same position.
<li>All the pieces are stable.  Since pieces are merely stacked, 
their centers of masses must be carefully positioned so as not to 
collapse.
<li>The pieces are stacked in a tree-like form 
in order to symbolize boundless potentiality of young artists.
In other words, one and only one
piece touches the ground, and each of other pieces touches one and
only one piece on its bottom faces.
<li>The building has a flat shape.
  This is because the construction site
  is a narrow area located between a
  straight moat and an expressway where 
  no more than one block can be placed 
   between the moat and the
expressway as illustrated below.
</ul>
<!-- end en only -->
<p style="text-align: center">
<img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_D2010_D-2">
</p>

<!-- begin en only -->
<p>It will take many days to fully check stability of designs as it requires 
complicated structural calculation.
Therefore, you are
asked to quickly check obviously unstable designs by focusing on 
centers of masses.  The rules of your quick check are as follows.</p>

<p> Assume the center of mass of a block is located at the center of the
block, and all blocks have the same weight.  
We denote a location of a block by <i>xy</i>-coordinates of its
left-bottom corner.  The unit length is the edge length of a block.
</p>
<p> 
Among the blocks of the piece that touch another piece or the ground on their
bottom faces, let <i>x<sub>L</sub></i> be the leftmost <i>x</i>-coordinate of 
the leftmost block, and let <i>x<sub>R</sub></i> be the rightmost
<i>x</i>-coordinate of the rightmost block.
Let the <i>x</i>-coordinate of its accumulated center of mass of
the piece be <i>M</i>, where the accumulated center of mass of a piece <i>P</i>
is the center of the mass of the pieces that are directly and indirectly 
supported by <i>P</i>, in addition to <i>P</i> itself.  Then the piece is
stable, if and only if
<i>x<sub>L</sub></i> &lt; <i>M</i> &lt; <i>x<sub>R</sub></i>.  Otherwise, it is
unstable.  A design of a building is unstable if any of its pieces is unstable.
</p><p>
Note that the above rules could  judge some designs to be unstable even 
if it would not collapse in reality.  For example, the left one of the
following designs shall be judged to be unstable.
</p>
<!-- end en only -->
<table><tr>
<td><img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_D2010_D-3" ></td>
<td></td>
<td><img src="https://judgeapi.u-aizu.ac.jp/resources/images/IMAGE2_D2010_D-4" ></td>
</tr></table>

<!-- begin en only -->
<p>Also note that the rules judge boundary cases to be unstable.  For example, the top piece in the above right design has its center of mass exactly above the right end of the bottom piece.  This shall be judged to be unstable.
</p><p>
Write a program that judges stability of each design based on the above quick check rules.
</p>
<!-- end en only -->





<h3>Input</h3>


<!-- begin en only -->
<p>
The input is a sequence of datasets.  The end of the input is
indicated by a line containing two zeros separated by a space.  Each
dataset, which represents a front view of a building, is formatted as follows.
</p>
<!-- end en only -->


<blockquote>

<i>w h</i>			<br>
<i>p</i><sub>0(<i>h</i>-1)</sub><i>p</i><sub>1(<i>h</i>-1)</sub>...<i>p</i><sub>(<i>w</i>-1)(<i>h</i>-1)</sub>	<br>
...		 	     <br>
<i>p</i><sub>01</sub><i>p</i><sub>11</sub>...<i>p</i><sub>(<i>w</i>-1)1</sub>	<br>
<i>p</i><sub>00</sub><i>p</i><sub>10</sub>...<i>p</i><sub>(<i>w</i>-1)0</sub>	<br>
</blockquote>
<!-- begin en only -->
<p>
The integers <i>w</i> and <i>h</i> separated by a space are the numbers of columns
and rows of the layout, respectively.  You may assume 1 &le; <i>w</i> &le;
10 and 1 &le; <i>h</i> &le; 60.  The next <i>h</i> lines specify the placement of
the pieces.  The character <i>p<sub>xy</sub></i> indicates the status of a block at
(<i>x</i>,<i>y</i>), either `<code>.</code>', meaning empty, or one digit character between
`<code>1</code>' and `<code>9</code>', inclusive, meaning a block of a piece.  
(As mentioned earlier, we denote a location of a block by <i>xy</i>-coordinates of its
left-bottom corner.)
</p><p>
When two blocks with the same number touch each other by any of their
top, bottom, left or right face, those blocks are of the same piece.
(Note that there might be two different pieces that are denoted by 
the same number.)
The bottom of a block at (<i>x</i>,0) touches the ground.
</p><p>
You may assume that the pieces in each dataset are stacked in a tree-like form.
</p>
<!-- end en only -->



<h3>Output</h3>

<!-- begin en only -->
<p>
For each dataset, output a line containing a word <code>STABLE</code>
when the design is stable with respect to the above quick check rules.
Otherwise, output <code>UNSTABLE</code>.  The output
should be written with uppercase letters, and should not contain any other extra characters.</p>
<!-- end en only -->


<h3>Sample Input</h3>

<pre>
4 5
..33
..33
2222
..1.
.111
5 7
....1
.1..1
.1..1
11..1
.2222
..111
...1.
3 6
.3.
233
23.
22.
.11
.11
4 3
2222
..11
..11
4 5
.3..
33..
322.
2211
.11.
3 3
222
2.1
111
3 4
11.
11.
.2.
222
3 4
.11
.11
.2.
222
2 7
11
.1
21
22
23
.3
33
2 3
1.
11
.1
0 0
</pre>


<h3>Output for the Sample Input</h3>

<pre>
STABLE
STABLE
STABLE
UNSTABLE
STABLE
STABLE
UNSTABLE
UNSTABLE
UNSTABLE
UNSTABLE
</pre>









